
---
import { getCollection, render, type CollectionEntry } from "astro:content";
import Layout from "~/layouts/Layout.astro";
import { Prose } from "@bibleio/design";
import Sidebar from "~/components/handbook/Sidebar.astro";
import { matchAuthorNames } from "~/utils/matchAuthorName";

export async function getStaticPaths() {
	const pages = await getCollection("handbook");
	return pages.map((page) => ({
		params: { id: page.id },
		props: { page },
	}));
}

const { page } = Astro.props;
const { Content } = await render(page);
---

<Layout title="Handbook">
  <section id="main" class="relative flex max-[600px]:flex-col gap-12 px-256 max-[1290px]:px-16 text-text min-h-screen pt-96 pb-64">
    <Sidebar imageCategory={page.data.category || "organization"} />
    <div id="content" class="bg-fg-1 backdrop-blur-popup border border-stroke rounded-16 w-full h-fit min-h-screen flex flex-col p-32 max-[600px]:p-12 gap-24 items-center">
      <div class="max-w-[32rem] w-full flex flex-col gap-12">
        <div class="flex gap-24 flex-wrap">
          <p class="text-sub">{matchAuthorNames(page.data.authors)}</p>
          <p class="text-sub capitalize">{page.data.category}</p>
          <p class="text-sub">{page.data.lastUpdated.toDateString()}</p>
        </div>
        <h1 class="text-h1">{page.data.title}</h1>
        <Prose><Content /></Prose>
      </div>
    </div>
  </section>
</Layout>
